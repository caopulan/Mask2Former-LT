# Copyright (c) Facebook, Inc. and its affiliates.
import os

from detectron2.data import DatasetCatalog, MetadataCatalog
from detectron2.data.datasets import load_sem_seg

# total image num: 40679
# categories num: 171
# number classes of frequent, common, rare (image frequency): 103, 34, 34
# number classes of frequent, common, rare (pixel frequency): 103, 34, 34
# ------------------------------------------------------------------------
#              |     min    |    rare    |    common    |    frequent    |
# ------------------------------------------------------------------------
#   image num  |      2     |     47     |     132      |     23557      |
# ------------------------------------------------------------------------
#   image freq | 0.00004916 | 0.00115538 |  0.00324491  |     0.579      |
# ------------------------------------------------------------------------
#   pixel num  | 0.01405553 | 3.1430514  |  15.284886   |    3491.0674   |
# ------------------------------------------------------------------------
#   pixel freq | 0.00000034 | 0.00007726 |  0.00037574  |    0.08581989  |
# ------------------------------------------------------------------------
# ps. freq = label num / total image num

coco_image_num = 40679

COCO_CATEGORIES = [
    {'color': [220, 20, 60], 'isthing': 1, 'id': 1, 'name': 'person', 'trainId': 0, 'image_count': 23557.0,
     'pixel_count': 3491.0674, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [119, 11, 32], 'isthing': 1, 'id': 2, 'name': 'bicycle', 'trainId': 1, 'image_count': 1417.0,
     'pixel_count': 91.02906, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 0, 142], 'isthing': 1, 'id': 3, 'name': 'car', 'trainId': 2, 'image_count': 5060.0,
     'pixel_count': 356.95294, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 0, 230], 'isthing': 1, 'id': 4, 'name': 'motorcycle', 'trainId': 3, 'image_count': 1981.0,
     'pixel_count': 346.2005, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [106, 0, 228], 'isthing': 1, 'id': 5, 'name': 'airplane', 'trainId': 4, 'image_count': 2125.0,
     'pixel_count': 270.51273, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 60, 100], 'isthing': 1, 'id': 6, 'name': 'bus', 'trainId': 5, 'image_count': 2144.0,
     'pixel_count': 515.3802, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 80, 100], 'isthing': 1, 'id': 7, 'name': 'train', 'trainId': 6, 'image_count': 512.0,
     'pixel_count': 162.79614, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 0, 70], 'isthing': 1, 'id': 8, 'name': 'truck', 'trainId': 7, 'image_count': 2840.0,
     'pixel_count': 404.1563, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 0, 192], 'isthing': 1, 'id': 9, 'name': 'boat', 'trainId': 8, 'image_count': 1021.0,
     'pixel_count': 113.4412, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [250, 170, 30], 'isthing': 1, 'id': 10, 'name': 'traffic light', 'trainId': 9, 'image_count': 1978.0,
     'pixel_count': 48.585197, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [100, 170, 30], 'isthing': 1, 'id': 11, 'name': 'fire hydrant', 'trainId': 10, 'image_count': 37.0,
     'pixel_count': 2.6402757, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [220, 220, 0], 'isthing': 1, 'id': 13, 'name': 'stop sign', 'trainId': 11, 'image_count': 40.0,
     'pixel_count': 2.7135885, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [175, 116, 175], 'isthing': 1, 'id': 14, 'name': 'parking meter', 'trainId': 12, 'image_count': 11.0,
     'pixel_count': 0.69185925, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [250, 0, 30], 'isthing': 1, 'id': 15, 'name': 'bench', 'trainId': 13, 'image_count': 2145.0,
     'pixel_count': 217.7584, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [165, 42, 42], 'isthing': 1, 'id': 16, 'name': 'bird', 'trainId': 14, 'image_count': 1399.0,
     'pixel_count': 93.9048, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [255, 77, 255], 'isthing': 1, 'id': 17, 'name': 'cat', 'trainId': 15, 'image_count': 1857.0,
     'pixel_count': 358.23834, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 226, 252], 'isthing': 1, 'id': 18, 'name': 'dog', 'trainId': 16, 'image_count': 1651.0,
     'pixel_count': 231.94136, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [182, 182, 255], 'isthing': 1, 'id': 19, 'name': 'horse', 'trainId': 17, 'image_count': 1582.0,
     'pixel_count': 234.03882, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 82, 0], 'isthing': 1, 'id': 20, 'name': 'sheep', 'trainId': 18, 'image_count': 27.0,
     'pixel_count': 3.4958582, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'color': [120, 166, 157], 'isthing': 1, 'id': 21, 'name': 'cow', 'trainId': 19, 'image_count': 51.0,
     'pixel_count': 6.289621, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [110, 76, 0], 'isthing': 1, 'id': 22, 'name': 'elephant', 'trainId': 20, 'image_count': 74.0,
     'pixel_count': 19.515951, 'image_frequency': 'common', 'pixel_frequency': 'frequent'},
    {'color': [174, 57, 255], 'isthing': 1, 'id': 23, 'name': 'bear', 'trainId': 21, 'image_count': 15.0,
     'pixel_count': 3.1430514, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'color': [199, 100, 0], 'isthing': 1, 'id': 24, 'name': 'zebra', 'trainId': 22, 'image_count': 47.0,
     'pixel_count': 8.701435, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [72, 0, 118], 'isthing': 1, 'id': 25, 'name': 'giraffe', 'trainId': 23, 'image_count': 109.0,
     'pixel_count': 18.310484, 'image_frequency': 'common', 'pixel_frequency': 'frequent'},
    {'color': [255, 179, 240], 'isthing': 1, 'id': 27, 'name': 'backpack', 'trainId': 24, 'image_count': 2082.0,
     'pixel_count': 43.5185, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 125, 92], 'isthing': 1, 'id': 28, 'name': 'umbrella', 'trainId': 25, 'image_count': 1758.0,
     'pixel_count': 181.6451, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [209, 0, 151], 'isthing': 1, 'id': 31, 'name': 'handbag', 'trainId': 26, 'image_count': 2358.0,
     'pixel_count': 51.47015, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [188, 208, 182], 'isthing': 1, 'id': 32, 'name': 'tie', 'trainId': 27, 'image_count': 96.0,
     'pixel_count': 2.5794523, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'color': [0, 220, 176], 'isthing': 1, 'id': 33, 'name': 'suitcase', 'trainId': 28, 'image_count': 92.0,
     'pixel_count': 12.985387, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [255, 99, 164], 'isthing': 1, 'id': 34, 'name': 'frisbee', 'trainId': 29, 'image_count': 75.0,
     'pixel_count': 1.0822515, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'color': [92, 0, 73], 'isthing': 1, 'id': 35, 'name': 'skis', 'trainId': 30, 'image_count': 1990.0,
     'pixel_count': 22.69864, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [133, 129, 255], 'isthing': 1, 'id': 36, 'name': 'snowboard', 'trainId': 31, 'image_count': 34.0,
     'pixel_count': 0.7706067, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [78, 180, 255], 'isthing': 1, 'id': 37, 'name': 'sports ball', 'trainId': 32, 'image_count': 1249.0,
     'pixel_count': 6.858324, 'image_frequency': 'frequent', 'pixel_frequency': 'common'},
    {'color': [0, 228, 0], 'isthing': 1, 'id': 38, 'name': 'kite', 'trainId': 33, 'image_count': 81.0,
     'pixel_count': 2.7920573, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'color': [174, 255, 243], 'isthing': 1, 'id': 39, 'name': 'baseball bat', 'trainId': 34, 'image_count': 103.0,
     'pixel_count': 0.54605395, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'color': [45, 89, 255], 'isthing': 1, 'id': 40, 'name': 'baseball glove', 'trainId': 35, 'image_count': 115.0,
     'pixel_count': 0.4985579, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'color': [134, 134, 103], 'isthing': 1, 'id': 41, 'name': 'skateboard', 'trainId': 36, 'image_count': 2033.0,
     'pixel_count': 50.146774, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [145, 148, 174], 'isthing': 1, 'id': 42, 'name': 'surfboard', 'trainId': 37, 'image_count': 2584.0,
     'pixel_count': 98.94206, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [255, 208, 186], 'isthing': 1, 'id': 43, 'name': 'tennis racket', 'trainId': 38, 'image_count': 1651.0,
     'pixel_count': 39.1254, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [197, 226, 255], 'isthing': 1, 'id': 44, 'name': 'bottle', 'trainId': 39, 'image_count': 1664.0,
     'pixel_count': 39.638805, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [171, 134, 1], 'isthing': 1, 'id': 46, 'name': 'wine glass', 'trainId': 40, 'image_count': 103.0,
     'pixel_count': 3.564485, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [109, 63, 54], 'isthing': 1, 'id': 47, 'name': 'cup', 'trainId': 41, 'image_count': 1772.0,
     'pixel_count': 53.64144, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [207, 138, 255], 'isthing': 1, 'id': 48, 'name': 'fork', 'trainId': 42, 'image_count': 485.0,
     'pixel_count': 3.9093351, 'image_frequency': 'frequent', 'pixel_frequency': 'common'},
    {'color': [151, 0, 95], 'isthing': 1, 'id': 49, 'name': 'knife', 'trainId': 43, 'image_count': 533.0,
     'pixel_count': 8.045986, 'image_frequency': 'frequent', 'pixel_frequency': 'common'},
    {'color': [9, 80, 61], 'isthing': 1, 'id': 50, 'name': 'spoon', 'trainId': 44, 'image_count': 594.0,
     'pixel_count': 6.136072, 'image_frequency': 'frequent', 'pixel_frequency': 'common'},
    {'color': [84, 105, 51], 'isthing': 1, 'id': 51, 'name': 'bowl', 'trainId': 45, 'image_count': 1209.0,
     'pixel_count': 126.62304, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [74, 65, 105], 'isthing': 1, 'id': 52, 'name': 'banana', 'trainId': 46, 'image_count': 70.0,
     'pixel_count': 12.439945, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [166, 196, 102], 'isthing': 1, 'id': 53, 'name': 'apple', 'trainId': 47, 'image_count': 24.0,
     'pixel_count': 2.3957918, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [208, 195, 210], 'isthing': 1, 'id': 54, 'name': 'sandwich', 'trainId': 48, 'image_count': 62.0,
     'pixel_count': 9.983745, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [255, 109, 65], 'isthing': 1, 'id': 55, 'name': 'orange', 'trainId': 49, 'image_count': 30.0,
     'pixel_count': 2.3477178, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [0, 143, 149], 'isthing': 1, 'id': 56, 'name': 'broccoli', 'trainId': 50, 'image_count': 38.0,
     'pixel_count': 3.9030838, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'color': [179, 0, 194], 'isthing': 1, 'id': 57, 'name': 'carrot', 'trainId': 51, 'image_count': 27.0,
     'pixel_count': 1.1767298, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [209, 99, 106], 'isthing': 1, 'id': 58, 'name': 'hot dog', 'trainId': 52, 'image_count': 18.0,
     'pixel_count': 3.9021199, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'color': [5, 121, 0], 'isthing': 1, 'id': 59, 'name': 'pizza', 'trainId': 53, 'image_count': 154.0,
     'pixel_count': 44.74029, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [227, 255, 205], 'isthing': 1, 'id': 60, 'name': 'donut', 'trainId': 54, 'image_count': 23.0,
     'pixel_count': 3.0887508, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [147, 186, 208], 'isthing': 1, 'id': 61, 'name': 'cake', 'trainId': 55, 'image_count': 137.0,
     'pixel_count': 20.144688, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [153, 69, 1], 'isthing': 1, 'id': 62, 'name': 'chair', 'trainId': 56, 'image_count': 3339.0,
     'pixel_count': 241.89532, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [3, 95, 161], 'isthing': 1, 'id': 63, 'name': 'couch', 'trainId': 57, 'image_count': 1424.0,
     'pixel_count': 258.37936, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [163, 255, 0], 'isthing': 1, 'id': 64, 'name': 'potted plant', 'trainId': 58, 'image_count': 1456.0,
     'pixel_count': 139.67331, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [119, 0, 170], 'isthing': 1, 'id': 65, 'name': 'bed', 'trainId': 59, 'image_count': 1010.0,
     'pixel_count': 346.71762, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 182, 199], 'isthing': 1, 'id': 67, 'name': 'dining table', 'trainId': 60, 'image_count': 2645.0,
     'pixel_count': 1054.406, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [0, 165, 120], 'isthing': 1, 'id': 70, 'name': 'toilet', 'trainId': 61, 'image_count': 1858.0,
     'pixel_count': 244.97443, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [183, 130, 88], 'isthing': 1, 'id': 72, 'name': 'tv', 'trainId': 62, 'image_count': 1163.0,
     'pixel_count': 138.5766, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [95, 32, 0], 'isthing': 1, 'id': 73, 'name': 'laptop', 'trainId': 63, 'image_count': 883.0,
     'pixel_count': 137.34868, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [130, 114, 135], 'isthing': 1, 'id': 74, 'name': 'mouse', 'trainId': 64, 'image_count': 42.0,
     'pixel_count': 0.47445425, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [110, 129, 133], 'isthing': 1, 'id': 75, 'name': 'remote', 'trainId': 65, 'image_count': 1298.0,
     'pixel_count': 44.49442, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [166, 74, 118], 'isthing': 1, 'id': 76, 'name': 'keyboard', 'trainId': 66, 'image_count': 67.0,
     'pixel_count': 7.532704, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [219, 142, 185], 'isthing': 1, 'id': 77, 'name': 'cell phone', 'trainId': 67, 'image_count': 1614.0,
     'pixel_count': 86.9174, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [79, 210, 114], 'isthing': 1, 'id': 78, 'name': 'microwave', 'trainId': 68, 'image_count': 29.0,
     'pixel_count': 2.4937613, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [178, 90, 62], 'isthing': 1, 'id': 79, 'name': 'oven', 'trainId': 69, 'image_count': 148.0,
     'pixel_count': 29.600515, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [65, 70, 15], 'isthing': 1, 'id': 80, 'name': 'toaster', 'trainId': 70, 'image_count': 3.0,
     'pixel_count': 0.014055532, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [127, 167, 115], 'isthing': 1, 'id': 81, 'name': 'sink', 'trainId': 71, 'image_count': 1329.0,
     'pixel_count': 86.222145, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [59, 105, 106], 'isthing': 1, 'id': 82, 'name': 'refrigerator', 'trainId': 72, 'image_count': 91.0,
     'pixel_count': 18.388926, 'image_frequency': 'common', 'pixel_frequency': 'frequent'},
    {'color': [142, 108, 45], 'isthing': 1, 'id': 84, 'name': 'book', 'trainId': 73, 'image_count': 1441.0,
     'pixel_count': 77.53736, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [196, 172, 0], 'isthing': 1, 'id': 85, 'name': 'clock', 'trainId': 74, 'image_count': 2381.0,
     'pixel_count': 110.01685, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [95, 54, 80], 'isthing': 1, 'id': 86, 'name': 'vase', 'trainId': 75, 'image_count': 1562.0,
     'pixel_count': 145.001, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'color': [128, 76, 255], 'isthing': 1, 'id': 87, 'name': 'scissors', 'trainId': 76, 'image_count': 15.0,
     'pixel_count': 0.3681076, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [201, 57, 1], 'isthing': 1, 'id': 88, 'name': 'teddy bear', 'trainId': 77, 'image_count': 66.0,
     'pixel_count': 10.017041, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'color': [246, 0, 122], 'isthing': 1, 'id': 89, 'name': 'hair drier', 'trainId': 78, 'image_count': 3.0,
     'pixel_count': 0.22015554, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'color': [191, 162, 208], 'isthing': 1, 'id': 90, 'name': 'toothbrush', 'trainId': 79, 'image_count': 13.0,
     'pixel_count': 0.2746547, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 92, 'name': 'banner', 'supercategory': 'textile', 'trainId': 80, 'image_count': 1396.0,
     'pixel_count': 110.388985, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 93, 'name': 'blanket', 'supercategory': 'textile', 'trainId': 81, 'image_count': 119.0,
     'pixel_count': 5.5715885, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 94, 'name': 'branch', 'supercategory': 'plant', 'trainId': 82, 'image_count': 140.0,
     'pixel_count': 12.383138, 'image_frequency': 'frequent', 'pixel_frequency': 'common'},
    {'id': 95, 'name': 'bridge', 'supercategory': 'building', 'trainId': 83, 'image_count': 34.0,
     'pixel_count': 3.6480505, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'id': 96, 'name': 'building-other', 'supercategory': 'building', 'trainId': 84, 'image_count': 9053.0,
     'pixel_count': 1687.7058, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 97, 'name': 'bush', 'supercategory': 'plant', 'trainId': 85, 'image_count': 2971.0, 'pixel_count': 192.42897,
     'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 98, 'name': 'cabinet', 'supercategory': 'furniture-stuff', 'trainId': 86, 'image_count': 1414.0,
     'pixel_count': 152.75854, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 99, 'name': 'cage', 'supercategory': 'structural', 'trainId': 87, 'image_count': 153.0,
     'pixel_count': 24.977287, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 100, 'name': 'cardboard', 'supercategory': 'raw-material', 'trainId': 88, 'image_count': 693.0,
     'pixel_count': 44.79672, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 101, 'name': 'carpet', 'supercategory': 'floor', 'trainId': 89, 'image_count': 1471.0,
     'pixel_count': 209.79222, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 102, 'name': 'ceiling-other', 'supercategory': 'ceiling', 'trainId': 90, 'image_count': 2818.0,
     'pixel_count': 303.81012, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 103, 'name': 'ceiling-tile', 'supercategory': 'ceiling', 'trainId': 91, 'image_count': 5.0,
     'pixel_count': 0.47106913, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 104, 'name': 'cloth', 'supercategory': 'textile', 'trainId': 92, 'image_count': 810.0,
     'pixel_count': 27.899538, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 105, 'name': 'clothes', 'supercategory': 'textile', 'trainId': 93, 'image_count': 8738.0,
     'pixel_count': 131.85582, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 106, 'name': 'clouds', 'supercategory': 'sky', 'trainId': 94, 'image_count': 4005.0,
     'pixel_count': 1188.4326, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 107, 'name': 'counter', 'supercategory': 'furniture-stuff', 'trainId': 95, 'image_count': 711.0,
     'pixel_count': 62.471832, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 108, 'name': 'cupboard', 'supercategory': 'furniture-stuff', 'trainId': 96, 'image_count': 16.0,
     'pixel_count': 1.3826767, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 109, 'name': 'curtain', 'supercategory': 'textile', 'trainId': 97, 'image_count': 1487.0,
     'pixel_count': 193.14807, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 110, 'name': 'desk-stuff', 'supercategory': 'furniture-stuff', 'trainId': 98, 'image_count': 149.0,
     'pixel_count': 15.284886, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 111, 'name': 'dirt', 'supercategory': 'ground', 'trainId': 99, 'image_count': 2267.0,
     'pixel_count': 323.70663, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 112, 'name': 'door-stuff', 'supercategory': 'furniture-stuff', 'trainId': 100, 'image_count': 2840.0,
     'pixel_count': 261.54758, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 113, 'name': 'fence', 'supercategory': 'structural', 'trainId': 101, 'image_count': 3455.0,
     'pixel_count': 368.19287, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 114, 'name': 'floor-marble', 'supercategory': 'floor', 'trainId': 102, 'image_count': 16.0,
     'pixel_count': 1.4359313, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 115, 'name': 'floor-other', 'supercategory': 'floor', 'trainId': 103, 'image_count': 2778.0,
     'pixel_count': 334.97983, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 116, 'name': 'floor-stone', 'supercategory': 'floor', 'trainId': 104, 'image_count': 20.0,
     'pixel_count': 2.4362633, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 117, 'name': 'floor-tile', 'supercategory': 'floor', 'trainId': 105, 'image_count': 2122.0,
     'pixel_count': 293.81976, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 118, 'name': 'floor-wood', 'supercategory': 'floor', 'trainId': 106, 'image_count': 1621.0,
     'pixel_count': 225.29984, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 119, 'name': 'flower', 'supercategory': 'plant', 'trainId': 107, 'image_count': 1210.0,
     'pixel_count': 123.99373, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 120, 'name': 'fog', 'supercategory': 'water', 'trainId': 108, 'image_count': 125.0, 'pixel_count': 27.952213,
     'image_frequency': 'common', 'pixel_frequency': 'frequent'},
    {'id': 121, 'name': 'food-other', 'supercategory': 'food-stuff', 'trainId': 109, 'image_count': 573.0,
     'pixel_count': 48.919117, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 122, 'name': 'fruit', 'supercategory': 'food-stuff', 'trainId': 110, 'image_count': 70.0,
     'pixel_count': 5.137745, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 123, 'name': 'furniture-other', 'supercategory': 'furniture-stuff', 'trainId': 111, 'image_count': 4816.0,
     'pixel_count': 304.03955, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 124, 'name': 'grass', 'supercategory': 'plant', 'trainId': 112, 'image_count': 6145.0,
     'pixel_count': 1065.4054, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 125, 'name': 'gravel', 'supercategory': 'ground', 'trainId': 113, 'image_count': 119.0,
     'pixel_count': 14.385839, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 126, 'name': 'ground-other', 'supercategory': 'ground', 'trainId': 114, 'image_count': 2124.0,
     'pixel_count': 362.225, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 127, 'name': 'hill', 'supercategory': 'solid', 'trainId': 115, 'image_count': 107.0,
     'pixel_count': 12.829297, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 128, 'name': 'house', 'supercategory': 'building', 'trainId': 116, 'image_count': 2223.0,
     'pixel_count': 188.4639, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 129, 'name': 'leaves', 'supercategory': 'plant', 'trainId': 117, 'image_count': 936.0,
     'pixel_count': 95.46628, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 130, 'name': 'light', 'supercategory': 'furniture-stuff', 'trainId': 118, 'image_count': 3404.0,
     'pixel_count': 49.962093, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 131, 'name': 'mat', 'supercategory': 'textile', 'trainId': 119, 'image_count': 9.0, 'pixel_count': 1.1412213,
     'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 132, 'name': 'metal', 'supercategory': 'raw-material', 'trainId': 120, 'image_count': 7252.0,
     'pixel_count': 330.05743, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 133, 'name': 'mirror-stuff', 'supercategory': 'furniture-stuff', 'trainId': 121, 'image_count': 1331.0,
     'pixel_count': 180.6395, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 134, 'name': 'moss', 'supercategory': 'plant', 'trainId': 122, 'image_count': 4.0, 'pixel_count': 0.49896717,
     'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 135, 'name': 'mountain', 'supercategory': 'solid', 'trainId': 123, 'image_count': 1729.0,
     'pixel_count': 234.2798, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 136, 'name': 'mud', 'supercategory': 'ground', 'trainId': 124, 'image_count': 10.0, 'pixel_count': 2.0100331,
     'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 137, 'name': 'napkin', 'supercategory': 'textile', 'trainId': 125, 'image_count': 23.0,
     'pixel_count': 0.8275732, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 138, 'name': 'net', 'supercategory': 'structural', 'trainId': 126, 'image_count': 22.0,
     'pixel_count': 2.6565485, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 139, 'name': 'paper', 'supercategory': 'raw-material', 'trainId': 127, 'image_count': 1998.0,
     'pixel_count': 75.3703, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 140, 'name': 'pavement', 'supercategory': 'ground', 'trainId': 128, 'image_count': 7687.0,
     'pixel_count': 1157.568, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 141, 'name': 'pillow', 'supercategory': 'textile', 'trainId': 129, 'image_count': 52.0,
     'pixel_count': 1.6849744, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'id': 142, 'name': 'plant-other', 'supercategory': 'plant', 'trainId': 130, 'image_count': 2676.0,
     'pixel_count': 253.26775, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 143, 'name': 'plastic', 'supercategory': 'raw-material', 'trainId': 131, 'image_count': 2832.0,
     'pixel_count': 101.72218, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 144, 'name': 'platform', 'supercategory': 'ground', 'trainId': 132, 'image_count': 55.0,
     'pixel_count': 6.37475, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 145, 'name': 'playingfield', 'supercategory': 'ground', 'trainId': 133, 'image_count': 1400.0,
     'pixel_count': 634.3139, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 146, 'name': 'railing', 'supercategory': 'structural', 'trainId': 134, 'image_count': 63.0,
     'pixel_count': 3.1260562, 'image_frequency': 'common', 'pixel_frequency': 'rare'},
    {'id': 147, 'name': 'railroad', 'supercategory': 'ground', 'trainId': 135, 'image_count': 132.0,
     'pixel_count': 15.1419115, 'image_frequency': 'frequent', 'pixel_frequency': 'common'},
    {'id': 148, 'name': 'river', 'supercategory': 'water', 'trainId': 136, 'image_count': 86.0,
     'pixel_count': 26.450651, 'image_frequency': 'common', 'pixel_frequency': 'frequent'},
    {'id': 149, 'name': 'road', 'supercategory': 'ground', 'trainId': 137, 'image_count': 7211.0,
     'pixel_count': 1402.1915, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 150, 'name': 'rock', 'supercategory': 'solid', 'trainId': 138, 'image_count': 710.0, 'pixel_count': 67.16269,
     'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 151, 'name': 'roof', 'supercategory': 'building', 'trainId': 139, 'image_count': 1437.0,
     'pixel_count': 52.387474, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 152, 'name': 'rug', 'supercategory': 'textile', 'trainId': 140, 'image_count': 131.0,
     'pixel_count': 10.456973, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 153, 'name': 'salad', 'supercategory': 'food-stuff', 'trainId': 141, 'image_count': 7.0,
     'pixel_count': 0.14120325, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 154, 'name': 'sand', 'supercategory': 'ground', 'trainId': 142, 'image_count': 1721.0,
     'pixel_count': 484.72125, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 155, 'name': 'sea', 'supercategory': 'water', 'trainId': 143, 'image_count': 3911.0,
     'pixel_count': 2065.5168, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 156, 'name': 'shelf', 'supercategory': 'furniture-stuff', 'trainId': 144, 'image_count': 1070.0,
     'pixel_count': 86.591, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 157, 'name': 'sky-other', 'supercategory': 'sky', 'trainId': 145, 'image_count': 12719.0,
     'pixel_count': 3254.0051, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 158, 'name': 'skyscraper', 'supercategory': 'building', 'trainId': 146, 'image_count': 55.0,
     'pixel_count': 5.850782, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 159, 'name': 'snow', 'supercategory': 'ground', 'trainId': 147, 'image_count': 2357.0,
     'pixel_count': 1148.6431, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 160, 'name': 'solid-other', 'supercategory': 'solid', 'trainId': 148, 'image_count': 12.0,
     'pixel_count': 0.77203846, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 161, 'name': 'stairs', 'supercategory': 'furniture-stuff', 'trainId': 149, 'image_count': 126.0,
     'pixel_count': 4.6541805, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 162, 'name': 'stone', 'supercategory': 'solid', 'trainId': 150, 'image_count': 45.0,
     'pixel_count': 4.3003874, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'id': 163, 'name': 'straw', 'supercategory': 'plant', 'trainId': 151, 'image_count': 22.0,
     'pixel_count': 3.6324244, 'image_frequency': 'rare', 'pixel_frequency': 'common'},
    {'id': 164, 'name': 'structural-other', 'supercategory': 'structural', 'trainId': 152, 'image_count': 991.0,
     'pixel_count': 86.17441, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 165, 'name': 'table', 'supercategory': 'furniture-stuff', 'trainId': 153, 'image_count': 3606.0,
     'pixel_count': 310.11743, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 166, 'name': 'tent', 'supercategory': 'building', 'trainId': 154, 'image_count': 24.0,
     'pixel_count': 1.2461078, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 167, 'name': 'textile-other', 'supercategory': 'textile', 'trainId': 155, 'image_count': 3548.0,
     'pixel_count': 201.47223, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 168, 'name': 'towel', 'supercategory': 'textile', 'trainId': 156, 'image_count': 113.0,
     'pixel_count': 4.3958955, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 169, 'name': 'tree', 'supercategory': 'plant', 'trainId': 157, 'image_count': 12078.0,
     'pixel_count': 2148.076, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 170, 'name': 'vegetable', 'supercategory': 'food-stuff', 'trainId': 158, 'image_count': 58.0,
     'pixel_count': 3.8265471, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 171, 'name': 'wall-brick', 'supercategory': 'wall', 'trainId': 159, 'image_count': 1778.0,
     'pixel_count': 255.78464, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 172, 'name': 'wall-concrete', 'supercategory': 'wall', 'trainId': 160, 'image_count': 9492.0,
     'pixel_count': 1794.1504, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 173, 'name': 'wall-other', 'supercategory': 'wall', 'trainId': 161, 'image_count': 5980.0,
     'pixel_count': 1012.68823, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 174, 'name': 'wall-panel', 'supercategory': 'wall', 'trainId': 162, 'image_count': 88.0,
     'pixel_count': 12.029266, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 175, 'name': 'wall-stone', 'supercategory': 'wall', 'trainId': 163, 'image_count': 58.0,
     'pixel_count': 7.03896, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 176, 'name': 'wall-tile', 'supercategory': 'wall', 'trainId': 164, 'image_count': 1698.0,
     'pixel_count': 449.51825, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 177, 'name': 'wall-wood', 'supercategory': 'wall', 'trainId': 165, 'image_count': 1810.0,
     'pixel_count': 256.03513, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 178, 'name': 'water-other', 'supercategory': 'water', 'trainId': 166, 'image_count': 98.0,
     'pixel_count': 22.762522, 'image_frequency': 'common', 'pixel_frequency': 'frequent'},
    {'id': 179, 'name': 'waterdrops', 'supercategory': 'water', 'trainId': 167, 'image_count': 2.0,
     'pixel_count': 0.21715663, 'image_frequency': 'rare', 'pixel_frequency': 'rare'},
    {'id': 180, 'name': 'window-blind', 'supercategory': 'window', 'trainId': 168, 'image_count': 82.0,
     'pixel_count': 6.847454, 'image_frequency': 'common', 'pixel_frequency': 'common'},
    {'id': 181, 'name': 'window-other', 'supercategory': 'window', 'trainId': 169, 'image_count': 4738.0,
     'pixel_count': 469.65198, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
    {'id': 182, 'name': 'wood', 'supercategory': 'solid', 'trainId': 170, 'image_count': 1162.0,
     'pixel_count': 64.52538, 'image_frequency': 'frequent', 'pixel_frequency': 'frequent'},
]


def _get_coco_stuff_lt_40_meta():
    stuff_ids = [k["id"] for k in COCO_CATEGORIES]
    assert len(stuff_ids) == 171, len(stuff_ids)

    # For semantic segmentation, this mapping maps from contiguous stuff id
    # (in [0, 91], used in models) to ids in the dataset (used for processing results)
    stuff_dataset_id_to_contiguous_id = {k: i for i, k in enumerate(stuff_ids)}
    stuff_classes = [k["name"] for k in COCO_CATEGORIES]
    image_count = [k["image_count"] for k in COCO_CATEGORIES]
    image_frequency = [k["image_frequency"] for k in COCO_CATEGORIES]
    pixel_count = [k["pixel_count"] for k in COCO_CATEGORIES]
    pixel_frequency = [k["pixel_frequency"] for k in COCO_CATEGORIES]

    ret = {
        "stuff_dataset_id_to_contiguous_id": stuff_dataset_id_to_contiguous_id,
        "stuff_classes": stuff_classes,
        "image_count": image_count,
        "image_frequency": image_frequency,
        "pixel_count": pixel_count,
        "pixel_frequency": pixel_frequency,
    }
    return ret


def register_all_coco_stuff_lt_40k(root):
    root = os.path.join(root, "coco_stuff_lt_40k")
    meta = _get_coco_stuff_lt_40_meta()
    for name, image_dirname, sem_seg_dirname in [
        ("train", "images/train2017", "annotations/train2017"),
        ("val", "images/val2017", "annotations/val2017"),
    ]:
        image_dir = os.path.join(root, image_dirname)
        gt_dir = os.path.join(root, sem_seg_dirname)
        name = f"coco_stuff_lt_40k_sem_seg_{name}"
        DatasetCatalog.register(
            name, lambda x=image_dir, y=gt_dir: load_sem_seg(y, x, gt_ext="png", image_ext="jpg")
        )
        MetadataCatalog.get(name).set(
            frequency=meta,
            stuff_classes=meta["stuff_classes"][:],
            image_root=image_dir,
            sem_seg_root=gt_dir,
            evaluator_type="lt_sem_seg",
            ignore_label=255,
        )


_root = os.getenv("DETECTRON2_DATASETS", "datasets")
register_all_coco_stuff_lt_40k(_root)
